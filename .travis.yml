---
#
# Ansible managed
#
language: python

os: linux
dist: xenial

python:
  - "3.8"

services:
  - docker

env:
  global:
    namespace="robertdebock"
  jobs:
    - image="centos" tag="latest"

cache:
  - pip

install:
  - pip install --upgrade pip
  - pip install tox

script:
  - function retry { counter=0 ; until "$@" ; do exit=$? ; counter=$(($counter + 1)) ; if [ $counter -ge 3 ] ; then return $exit ; fi ; done ; return 0; } ; retry tox

notifications:
  webhooks: https://galaxy.ansible.com/api/v1/notifications/
  slack:
    secure: "w6DwhlVKltglD0Q8iwYG7nS1pUFL2BO5TMMwOCjXc13+ejdH4cSXfwNiHHTKZBqvsaier0pHihCpvzs1I2PB2Lifp3YLqcRzpovggV4Yq+pr4VjA/BPw4946OMqKTNLBugWmhLQE8F3s39azE4e9xWGrXhuJyVhLPWiZGV5EMNxtCb1FTgdHvr0UTnm0hZn3HjSuVMH2Hotfw2gu5L5vnRGUadZMhQ0zsOrUYcKdKaiLs7d6dQ83wdu0AXUI8yz5KuJRPu1M+xN7qMoQoLMjFxmID5uvIH/N1Lf3pWtQYcwq7YRuz0rxVcA+o2aPkKQRCSOZ7VmOtuqG5mKzo5is8rcLd8jca7gp5EXieYwSXMCpSd7RLeoCmYzHLVOmqrtURm52cwLHgYJrLa7LaW//R+A9p3ACaq3Qo5OArvB1zK+X7JUyk8ZigfenDJZYo3vRm2+4C2/7Df/3kUndTCsWA2btDmXBhlOSg6ujjlno+lLmhHsDvXHFISoaZM+++n/O4QiW2y/vu3TQbj0W+vMol3WpFS4Vd+455ITmoXXi1MXcNpz5p9zThPFqeKypdAVpYZDSKxAHmqSzzEemJeHcb8z4maPcRndEJFz60clilM28NFKnaRP12FznRHKXR/qK0w5jZJUGYxz38rzQArSwT8YTzxlGwiNib8GMBWGRrL4="
    on_success: change
    template: "%{result}: %{repository_slug}@%{branch}, build <%{build_url}|#%{build_number}> (<%{compare_url}|%{commit}>)"
  email: false
